<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>A Prometheus Client for R Using the OpenMetrics Format • openmetrics</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="bootstrap-toc.css">
<script src="bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="pkgdown.css" rel="stylesheet">
<script src="pkgdown.js"></script><meta property="og:title" content="A Prometheus Client for R Using the OpenMetrics Format">
<meta property="og:description" content="Provides a client for the open-source monitoring and alerting
  toolkit, Prometheus, that emits metrics in the OpenMetrics format. Allows
  users to automatically instrument Plumber and Shiny applications, collect
  standard process metrics, as well as define custom counter, gauge, and
  histogram metrics of their own.">
<meta property="og:image" content="https://atheriel.github.io/openmetrics/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-home">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="index.html">openmetrics</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.3.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="reference/index.html">Reference</a>
</li>
<li>
  <a href="news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/atheriel/openmetrics/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="contents col-md-9">
<div id="openmetrics-" class="section level1">
<div class="page-header"><h1 class="hasAnchor">
<a href="#openmetrics-" class="anchor"></a>openmetrics <img src="reference/figures/logo.png" align="right" height="139">
</h1></div>
<!-- badges: start -->

<p><strong>openmetrics</strong> is an opinionated client for <a href="https://prometheus.io/">Prometheus</a> and the related <a href="https://openmetrics.io/">OpenMetrics</a> project. It makes it possible to add predefined and custom metrics to any R web application and expose them on a <code>/metrics</code> endpoint, where they can be consumed by Prometheus services.</p>
<p>The package includes built-in support for <a href="https://www.rplumber.io/">Plumber</a> and <a href="https://shiny.rstudio.com/">Shiny</a> applications, but is highly extensible.</p>
<div id="installation" class="section level2">
<h2 class="hasAnchor">
<a href="#installation" class="anchor"></a>Installation</h2>
<p>You can install <strong>openmetrics</strong> from CRAN with</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html">install.packages</a></span><span class="op">(</span><span class="st">"openmetrics"</span><span class="op">)</span></code></pre></div>
<p>or from GitHub with</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># install.packages("remotes")</span>
<span class="fu">remotes</span><span class="fu">::</span><span class="fu"><a href="https://remotes.r-lib.org/reference/install_github.html">install_github</a></span><span class="op">(</span><span class="st">"atheriel/openmetrics"</span><span class="op">)</span></code></pre></div>
</div>
<div id="use-with-plumber" class="section level2">
<h2 class="hasAnchor">
<a href="#use-with-plumber" class="anchor"></a>Use with Plumber</h2>
<p>You can easily wrap an existing Plumber router object to add metrics for HTTP requests and their duration:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">srv</span> <span class="op">&lt;-</span> <span class="fu">plumber</span><span class="fu">::</span><span class="fu"><a href="https://www.rplumber.io/reference/plumb.html">plumb</a></span><span class="op">(</span><span class="st">"plumber.R"</span><span class="op">)</span>
<span class="va">srv</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/register_plumber_metrics.html">register_plumber_metrics</a></span><span class="op">(</span><span class="va">srv</span><span class="op">)</span>
<span class="va">srv</span><span class="op">$</span><span class="fu">run</span><span class="op">(</span><span class="op">)</span></code></pre></div>
<p>This will automatically create a <code>/metrics</code> endpoint that exposes these metrics (and any others you have defined).</p>
<div id="authentication" class="section level3">
<h3 class="hasAnchor">
<a href="#authentication" class="anchor"></a>Authentication</h3>
<p>To add authentication to this endpoint, set the <code>METRICS_HTTP_AUTHORIZATION</code> environment variable to the expected <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Authorization"><code>Authorization</code></a> header you want Prometheus to use. For example, to grant access to the username “aladdin” with password “opensesame”:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1"></a><span class="kw">Sys.setenv</span>(<span class="dt">METRICS_HTTP_AUTHORIZATION =</span> <span class="st">"Basic YWxhZGRpbjpvcGVuc2VzYW1l"</span>)</span></code></pre></div>
<p>Meanwhile, in your Prometheus configuration:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb5-1"><a href="#cb5-1"></a><span class="fu">scrape_configs</span><span class="kw">:</span></span>
<span id="cb5-2"><a href="#cb5-2"></a><span class="co"># ...</span></span>
<span id="cb5-3"><a href="#cb5-3"></a><span class="kw">-</span><span class="at"> </span><span class="fu">job_name</span><span class="kw">:</span><span class="at"> my-plumber-api</span></span>
<span id="cb5-4"><a href="#cb5-4"></a><span class="at">  </span><span class="fu">basic_auth</span><span class="kw">:</span></span>
<span id="cb5-5"><a href="#cb5-5"></a><span class="at">    </span><span class="fu">username</span><span class="kw">:</span><span class="at"> aladdin</span></span>
<span id="cb5-6"><a href="#cb5-6"></a><span class="at">    </span><span class="fu">password</span><span class="kw">:</span><span class="at"> opensesame</span></span>
<span id="cb5-7"><a href="#cb5-7"></a><span class="co">  # ...</span></span></code></pre></div>
</div>
</div>
<div id="use-with-shiny" class="section level2">
<h2 class="hasAnchor">
<a href="#use-with-shiny" class="anchor"></a>Use with Shiny</h2>
<p>You can also wrap an existing Shiny app object to add metrics on reactive flush duration and a running session count. In your <code>app.R</code> file, you can use something like the following:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">app</span> <span class="op">&lt;-</span> <span class="fu">shiny</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/shiny/man/shinyApp.html">shinyApp</a></span><span class="op">(</span><span class="va">...</span><span class="op">)</span>
<span class="va">app</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/register_shiny_metrics.html">register_shiny_metrics</a></span><span class="op">(</span><span class="va">app</span><span class="op">)</span>
<span class="va">app</span></code></pre></div>
<p>Which will be picked up by <code><a href="https://rdrr.io/pkg/shiny/man/runApp.html">shiny::runApp()</a></code>.</p>
<p>Again, this will automatically create a <code>/metrics</code> endpoint that exposes these metrics (and any others you have defined). It supports the same authentication method as well.</p>
<p><strong>This feature should be considered experimental</strong>. It relies on certain unstable Shiny internals to add the <code>/metrics</code> endpoint, which <a href="https://github.com/rstudio/shiny/issues/2395">is not usually possible</a>.</p>
</div>
<div id="default-process-metrics" class="section level2">
<h2 class="hasAnchor">
<a href="#default-process-metrics" class="anchor"></a>Default Process Metrics</h2>
<p>You can enable the <a href="https://prometheus.io/docs/instrumenting/writing_clientlibs/#process-metrics">default process metrics</a> (which track CPU time, memory usage, and open files) with</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="reference/register_default_metrics.html">register_default_metrics</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<p>Note that not all metrics are supported (or even meaningful) on all operating systems.</p>
</div>
<div id="custom-metrics" class="section level2">
<h2 class="hasAnchor">
<a href="#custom-metrics" class="anchor"></a>Custom Metrics</h2>
<p>All required metrics and features of <a href="https://prometheus.io/docs/instrumenting/writing_clientlibs/">the informal Prometheus client specification</a> are supported, so you can create app-specific <a href="https://prometheus.io/docs/concepts/metric_types/">counters, gauges, and histograms</a>. If you want to make use of labels, you must pass a default value at the time of creation.</p>
<p>Here are some examples collected from around the house:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">meows</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/metrics.html">counter_metric</a></span><span class="op">(</span><span class="st">"meows"</span>, <span class="st">"Heard around the house."</span>, labels <span class="op">=</span> <span class="st">"cat"</span><span class="op">)</span>
<span class="va">meows</span><span class="op">$</span><span class="fu">inc</span><span class="op">(</span>cat <span class="op">=</span> <span class="st">"Shamus"</span><span class="op">)</span> <span class="co"># Count one meow from Shamus.</span>
<span class="va">meows</span><span class="op">$</span><span class="fu">inc</span><span class="op">(</span><span class="fl">3</span>, cat <span class="op">=</span> <span class="st">"Unknown"</span><span class="op">)</span> <span class="co"># Count three meows of unknown origin.</span>

<span class="va">thermostat</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/metrics.html">gauge_metric</a></span><span class="op">(</span><span class="st">"thermostat"</span>, <span class="st">"Thermostat display."</span><span class="op">)</span>
<span class="va">thermostat</span><span class="op">$</span><span class="fu">set</span><span class="op">(</span><span class="fl">21.3</span><span class="op">)</span> <span class="co"># Read from the display...</span>
<span class="va">thermostat</span><span class="op">$</span><span class="fu">dec</span><span class="op">(</span><span class="fl">2</span><span class="op">)</span> <span class="co"># ... and then turn it down 2 degrees.</span>

<span class="va">temperature</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/metrics.html">histogram_metric</a></span><span class="op">(</span>
  <span class="st">"temperature"</span>, <span class="st">"Ambient room temperature measurements."</span>,
  buckets <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">10</span>, <span class="fl">15</span>, <span class="fl">20</span>, <span class="fl">22</span>, <span class="fl">25</span><span class="op">)</span>, room <span class="op">=</span> <span class="st">"kitchen"</span>
<span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">9090</span><span class="op">)</span>
<span class="co"># Simulate taking ambient temperature samples.</span>
<span class="kw">for</span> <span class="op">(</span><span class="va">measure</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fl">20</span>, mean <span class="op">=</span> <span class="fl">21.5</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span>
  <span class="va">temperature</span><span class="op">$</span><span class="fu">observe</span><span class="op">(</span><span class="va">measure</span>, room <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"kitchen"</span>, <span class="st">"bathroom"</span><span class="op">)</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span>
<span class="op">}</span></code></pre></div>
<p>All metrics (in fact all exported functions) take a <code>registry</code> parameter in case you want to avoid using the default global registry in some part of your application. You can construct new registries with <code><a href="reference/registry.html">registry()</a></code>.</p>
<div id="performance" class="section level3">
<h3 class="hasAnchor">
<a href="#performance" class="anchor"></a>Performance</h3>
<p>Because metrics may be gathered with high frequency, some effort has been made to ensure that using them is fast – usually around 10 microseconds.</p>
</div>
<div id="rendering-metrics-manually" class="section level3">
<h3 class="hasAnchor">
<a href="#rendering-metrics-manually" class="anchor"></a>Rendering Metrics Manually</h3>
<p>The <code><a href="reference/registry.html">render_metrics()</a></code> function exposes the <a href="https://github.com/OpenObservability/OpenMetrics/blob/main/specification/OpenMetrics.md">text-based OpenMetrics format</a> understood by Prometheus. Here’s what the metrics above look like:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span><span class="fu"><a href="reference/registry.html">render_metrics</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb10"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1"></a><span class="co"># HELP meows Heard around the house.</span></span>
<span id="cb10-2"><a href="#cb10-2"></a><span class="co"># TYPE meows counter</span></span>
<span id="cb10-3"><a href="#cb10-3"></a>meows_total{cat=<span class="st">"Shamus"</span>} <span class="dv">1</span></span>
<span id="cb10-4"><a href="#cb10-4"></a>meows_created{cat=<span class="st">"Shamus"</span>} <span class="fl">1604597246.05814</span></span>
<span id="cb10-5"><a href="#cb10-5"></a>meows_total{cat=<span class="st">"Unknown"</span>} <span class="dv">3</span></span>
<span id="cb10-6"><a href="#cb10-6"></a>meows_created{cat=<span class="st">"Unknown"</span>} <span class="fl">1604597246.05893</span></span>
<span id="cb10-7"><a href="#cb10-7"></a><span class="co"># HELP thermostat Thermostat display.</span></span>
<span id="cb10-8"><a href="#cb10-8"></a><span class="co"># TYPE thermostat gauge</span></span>
<span id="cb10-9"><a href="#cb10-9"></a>thermostat <span class="fl">19.3</span></span>
<span id="cb10-10"><a href="#cb10-10"></a><span class="co"># HELP temperature Ambient room temperature measurements.</span></span>
<span id="cb10-11"><a href="#cb10-11"></a><span class="co"># TYPE temperature histogram</span></span>
<span id="cb10-12"><a href="#cb10-12"></a>temperature_bucket{room=<span class="st">"bathroom"</span>,le=<span class="st">"10.0"</span>} <span class="dv">0</span></span>
<span id="cb10-13"><a href="#cb10-13"></a>temperature_bucket{room=<span class="st">"bathroom"</span>,le=<span class="st">"15.0"</span>} <span class="dv">0</span></span>
<span id="cb10-14"><a href="#cb10-14"></a>temperature_bucket{room=<span class="st">"bathroom"</span>,le=<span class="st">"20.0"</span>} <span class="dv">0</span></span>
<span id="cb10-15"><a href="#cb10-15"></a>temperature_bucket{room=<span class="st">"bathroom"</span>,le=<span class="st">"22.0"</span>} <span class="dv">9</span></span>
<span id="cb10-16"><a href="#cb10-16"></a>temperature_bucket{room=<span class="st">"bathroom"</span>,le=<span class="st">"25.0"</span>} <span class="dv">11</span></span>
<span id="cb10-17"><a href="#cb10-17"></a>temperature_bucket{room=<span class="st">"bathroom"</span>,le=<span class="st">"+Inf"</span>} <span class="dv">11</span></span>
<span id="cb10-18"><a href="#cb10-18"></a>temperature_sum{room=<span class="st">"bathroom"</span>} <span class="fl">234.387663039796</span></span>
<span id="cb10-19"><a href="#cb10-19"></a>temperature_count{room=<span class="st">"bathroom"</span>} <span class="dv">11</span></span>
<span id="cb10-20"><a href="#cb10-20"></a>temperature_created{room=<span class="st">"bathroom"</span>} <span class="fl">1604597246.08967</span></span>
<span id="cb10-21"><a href="#cb10-21"></a>temperature_bucket{room=<span class="st">"kitchen"</span>,le=<span class="st">"10.0"</span>} <span class="dv">0</span></span>
<span id="cb10-22"><a href="#cb10-22"></a>temperature_bucket{room=<span class="st">"kitchen"</span>,le=<span class="st">"15.0"</span>} <span class="dv">0</span></span>
<span id="cb10-23"><a href="#cb10-23"></a>temperature_bucket{room=<span class="st">"kitchen"</span>,le=<span class="st">"20.0"</span>} <span class="dv">1</span></span>
<span id="cb10-24"><a href="#cb10-24"></a>temperature_bucket{room=<span class="st">"kitchen"</span>,le=<span class="st">"22.0"</span>} <span class="dv">4</span></span>
<span id="cb10-25"><a href="#cb10-25"></a>temperature_bucket{room=<span class="st">"kitchen"</span>,le=<span class="st">"25.0"</span>} <span class="dv">9</span></span>
<span id="cb10-26"><a href="#cb10-26"></a>temperature_bucket{room=<span class="st">"kitchen"</span>,le=<span class="st">"+Inf"</span>} <span class="dv">9</span></span>
<span id="cb10-27"><a href="#cb10-27"></a>temperature_sum{room=<span class="st">"kitchen"</span>} <span class="fl">198.854388891071</span></span>
<span id="cb10-28"><a href="#cb10-28"></a>temperature_count{room=<span class="st">"kitchen"</span>} <span class="dv">9</span></span>
<span id="cb10-29"><a href="#cb10-29"></a>temperature_created{room=<span class="st">"kitchen"</span>} <span class="fl">1604597246.08957</span></span>
<span id="cb10-30"><a href="#cb10-30"></a><span class="co"># EOF</span></span></code></pre></div>
<p>You can use this to implement a <code>/metrics</code> endpoint in your application if it is not supported directly. For example, using a raw <strong>httpuv</strong> server:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">httpuv</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/httpuv/man/runServer.html">runServer</a></span><span class="op">(</span>
  <span class="st">"127.0.0.1"</span>, <span class="fl">8080</span>,
  <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>call <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">req</span><span class="op">)</span> <span class="op">{</span>
    <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>
      status <span class="op">=</span> <span class="fl">200L</span>,
      headers <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="st">"Content-Type"</span> <span class="op">=</span> <span class="st">"text/plain; version=0.0.4"</span><span class="op">)</span>,
      body <span class="op">=</span> <span class="fu"><a href="reference/registry.html">render_metrics</a></span><span class="op">(</span><span class="op">)</span>
    <span class="op">)</span>
  <span class="op">}</span><span class="op">)</span>
<span class="op">)</span></code></pre></div>
</div>
</div>
<div id="pushgateway-support" class="section level2">
<h2 class="hasAnchor">
<a href="#pushgateway-support" class="anchor"></a>Pushgateway Support</h2>
<p>Some workloads may not want to run an HTTP server to expose metrics, especially in the case of short-lived batch jobs. For these cases metrics can also be manually “pushed” to a Prometheus Pushgateway instance, though <a href="https://prometheus.io/docs/practices/pushing/">there are drawbacks to this approach</a>.</p>
<p><code><a href="reference/push_to_gateway.html">push_to_gateway()</a></code> can be used to push metrics, and <code><a href="reference/push_to_gateway.html">delete_from_gateway()</a></code> can be used to clean them up when the workload is finished:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="reference/push_to_gateway.html">push_to_gateway</a></span><span class="op">(</span><span class="st">"localhost:9091"</span>, job <span class="op">=</span> <span class="st">"openmetrics-readme"</span><span class="op">)</span>
<span class="co"># Some time later...</span>
<span class="fu"><a href="reference/push_to_gateway.html">delete_from_gateway</a></span><span class="op">(</span><span class="st">"localhost:9091"</span>, job <span class="op">=</span> <span class="st">"openmetrics-readme"</span><span class="op">)</span></code></pre></div>
</div>
<div id="limitations" class="section level2">
<h2 class="hasAnchor">
<a href="#limitations" class="anchor"></a>Limitations</h2>
<ul>
<li><p>The Summary metric is not available, as it is not required by the spec if a Histogram is available. It is also difficult to implement, and <a href="https://www.robustperception.io/how-does-a-prometheus-summary-work">could be considered a design error</a>.</p></li>
<li><p>Most of the default process metrics are absent on non-Linux systems. This is basically because they were designed with Linux in mind, and very few Prometheus clients support them for anything but Linux.</p></li>
</ul>
</div>
<div id="license" class="section level2">
<h2 class="hasAnchor">
<a href="#license" class="anchor"></a>License</h2>
<p>The package is made available under the terms of the MIT license. See <code>LICENSE</code> for details.</p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <div class="links">
<h2>Links</h2>
<ul class="list-unstyled">
<li>Download from CRAN at <br><a href="https://cloud.r-project.org/package=openmetrics">https://​cloud.r-project.org/​package=openmetrics</a>
</li>
<li>Browse source code at <br><a href="https://github.com/atheriel/openmetrics/">https://​github.com/​atheriel/​openmetrics/​</a>
</li>
<li>Report a bug at <br><a href="https://github.com/atheriel/openmetrics/issues">https://​github.com/​atheriel/​openmetrics/​issues</a>
</li>
</ul>
</div>
<div class="license">
<h2>License</h2>
<ul class="list-unstyled">
<li>
<a href="https://opensource.org/licenses/mit-license.php">MIT</a> + file <a href="LICENSE-text.html">LICENSE</a>
</li>
</ul>
</div>
<div class="developers">
<h2>Developers</h2>
<ul class="list-unstyled">
<li>Aaron Jacobs <br><small class="roles"> Author, maintainer </small>  </li>
<li><a href="authors.html">All authors...</a></li>
</ul>
</div>

  <div class="dev-status">
<h2>Dev status</h2>
<ul class="list-unstyled">
<li><a href="https://travis-ci.org/atheriel/openmetrics"><img src="https://travis-ci.org/atheriel/openmetrics.svg?branch=master" alt="travis-ci build status"></a></li>
<li><a href="https://cran.r-project.org/package=openmetrics"><img src="https://www.r-pkg.org/badges/version/openmetrics" alt="CRAN status"></a></li>
</ul>
</div>
</div>
</div>


      <footer><div class="copyright">
  <p>Developed by Aaron Jacobs.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
